{"componentChunkName":"component---src-templates-blog-post-js","path":"/nextjs-reactquery-useinfinitequery/","result":{"data":{"site":{"siteMetadata":{"title":"ê³µììœ¤ì˜ ê¸°ìˆ ë¸”ë¡œê·¸"}},"markdownRemark":{"id":"553ca892-f753-50be-8a67-0948af59f705","excerpt":"Next.js í”„ë¡œì íŠ¸ ìˆ˜í–‰ ì‹œ í•¨ê»˜ ì§„í–‰í•˜ëŠ” ì¤‘ìš” ê³¼ì œë¡œ ê¸°ì¡´ì˜ Reduxë¥¼ ê±·ì–´ë‚´ê³  ëª¨ë“  fetch dataë¥¼ React Queryâ€¦","html":"<p>Next.js í”„ë¡œì íŠ¸ ìˆ˜í–‰ ì‹œ í•¨ê»˜ ì§„í–‰í•˜ëŠ” ì¤‘ìš” ê³¼ì œë¡œ <strong>ê¸°ì¡´ì˜ Reduxë¥¼ ê±·ì–´ë‚´ê³  ëª¨ë“  fetch dataë¥¼ React Queryë¡œ ê´€ë¦¬í•˜ê¸°</strong>ê°€ ìˆìŠµë‹ˆë‹¤.\n<br />\nì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ë¬´í•œìŠ¤í¬ë¡¤ ì‹œ <code class=\"language-text\">react query</code>ë¥¼ ì‚¬ìš©í•´ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ ê³¼ì •ì„ ì •ë¦¬í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>\n<p>í˜„ì¬ ì €ëŠ” <code class=\"language-text\">InfiniteScroll</code> ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš© ì¤‘ì…ë‹ˆë‹¤. ë²„íŠ¼ ëŒ€ì‹  ìŠ¤í¬ë¡¤ì„ ë‚´ë ¸ì„ ë•Œ í˜ì´ì§• ì²˜ë¦¬ë¥¼ ì‰½ê²Œ í•´ ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ë°ìš”, ê°„ë‹¨í•œ ì‚¬ìš©ë²•ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>InfiniteScroll hasMore<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>hasMore<span class=\"token punctuation\">}</span> loadMore<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>loadMore<span class=\"token punctuation\">}</span> loader<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>loader<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>InfiniteScroll<span class=\"token operator\">></span></code></pre></div>\n<p>ì—¬ê¸°ì„œ <code class=\"language-text\">hasMore</code>ì€ ë°ì´í„°ê°€ ë” ìˆëŠ”ì§€ë¥¼ íŒë‹¨í•˜ëŠ” ê°’ì´ê³ , <code class=\"language-text\">loadMore</code>ì€ ì¼ë°˜ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ëŠ” <code class=\"language-text\">fetch</code> ì—­í• ì„ í•©ë‹ˆë‹¤.\nê·¸ë¦¬ê³  <code class=\"language-text\">loader</code>ëŠ” loadingì¤‘ì¼ ë•Œ returnë˜ëŠ” elementì…ë‹ˆë‹¤.</p>\n<p>ê¸°ì¡´ì—ëŠ” <code class=\"language-text\">redux</code>ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì—ˆê¸° ë•Œë¬¸ì— <code class=\"language-text\">loadMore</code> í˜¸ì¶œ ì‹œ í˜„ì¬ í˜ì´ì§€ì˜ ê°’ì—ì„œ 1ì„ ë”í•˜ì—¬ ë°ì´í„°ë¥¼ ë‹¤ì‹œ fetchí•˜ê³ , ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ <code class=\"language-text\">reducer</code>ì—ì„œ <code class=\"language-text\">merge</code>í•˜ì—¬ returní•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.\nì‚¬ì‹¤ <code class=\"language-text\">react query</code>ë„ ì‚¬ìš©ë²•ì€ ë³„ë°˜ ë‹¤ë¥¼ ë°”ê°€ ì—†ì—ˆìœ¼ë‚˜, ì‹¤ì œë¡œ ì‚¬ìš©í•´ ë³´ë‹ˆ <code class=\"language-text\">redux</code>ë¥¼ ì‚¬ìš©í•  ë•Œë³´ë‹¤ ì¢€ë” í¸ë¦¬í•˜ê²Œ ì“¸ ìˆ˜ ìˆëŠ” ëª‡ ê°€ì§€ ë°©ë²•ì´ ìˆì—ˆìŠµë‹ˆë‹¤.</p>\n<h2>useInfiniteQuery</h2>\n<p>ê¸°ì¡´ì˜ <code class=\"language-text\">useQuery</code> ëŒ€ì‹  <code class=\"language-text\">useInfiniteQuery</code>ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ì´ <code class=\"language-text\">hook</code>ì„ ì‚¬ìš©í•˜ë©´ <code class=\"language-text\">useQuery</code>ì—ì„œ returní•´ ì£¼ëŠ” <code class=\"language-text\">isLoading</code>, <code class=\"language-text\">data</code>, <code class=\"language-text\">isError</code> ì´ì™¸ì—ë„ ëª‡ ê°€ì§€ ê¸°ëŠ¥ì„ ë” ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<ul>\n<li><strong><em>fetchNextPage</em></strong>\n<ul>\n<li>ë‹¤ìŒ í˜ì´ì§€ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.</li>\n</ul>\n</li>\n<li><strong><em>fetchPreviousPage</em></strong>\n<ul>\n<li>ì´ì „ í˜ì´ì§€ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.</li>\n</ul>\n</li>\n<li><strong><em>hasNextPage</em></strong>\n<ul>\n<li>ë‹¤ìŒ í˜ì´ì§€ì˜ ë°ì´í„°ê°€ ìˆëŠ”ì§€ì˜ ì—¬ë¶€ë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤.</li>\n</ul>\n</li>\n<li><strong><em>hasPreviousPage</em></strong>\n<ul>\n<li>ì´ì „ í˜ì´ì§€ì˜ ë°ì´í„°ê°€ ìˆëŠ”ì§€ì˜ ì—¬ë¶€ë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤.</li>\n</ul>\n</li>\n<li><strong><em>isFetchingNextPage</em></strong>\n<ul>\n<li>ë‹¤ìŒ í˜ì´ì§€ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ì´ë¼ëŠ” ìƒíƒœë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤.</li>\n</ul>\n</li>\n<li><strong><em>isFetchingPreviousPage</em></strong>\n<ul>\n<li>ì´ì „ í˜ì´ì§€ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ì´ë¼ëŠ” ìƒíƒœë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤.</li>\n</ul>\n</li>\n</ul>\n<p>ë¬´í•œìŠ¤í¬ë¡¤ì˜ ê²½ìš° ì´ì „ í˜ì´ì§€ë¡œ ê°€ëŠ” ê²½ìš°ëŠ” ì—†ê¸° ë•Œë¬¸ì— ì €ëŠ” <code class=\"language-text\">fetchNextPage</code>, <code class=\"language-text\">hasNextPage</code>, <code class=\"language-text\">isFetchingNextPage</code> ì´ ì„¸ ê°€ì§€ ë¦¬í„´ê°’ë§Œ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.\nì´ ê°’ì„ <code class=\"language-text\">InfiniteScroll</code>ì˜ propì— ë§¤ì¹­ì‹œì¼œ ì¤ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token operator\">&lt;</span>InfiniteScroll hasMore<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>hasNextPage<span class=\"token punctuation\">}</span> loadMore<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>fetchNextPage<span class=\"token punctuation\">}</span> loader<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>loader<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>InfiniteScroll<span class=\"token operator\">></span></code></pre></div>\n<h3>pageParam</h3>\n<p>ê·¸ëŸ°ë° <code class=\"language-text\">react query</code>ì—ì„œëŠ” í˜ì´ì§€ì˜ ê°’ì„ ë„˜ê²¨ì£¼ì§€ë„ ì•Šì•˜ëŠ”ë° ì–´ë–»ê²Œ í˜ì´ì§€ ì •ë³´ë¥¼ ì•Œê³  ìë™ìœ¼ë¡œ <code class=\"language-text\">fetch</code>ë¥¼ í•´ì£¼ëŠ” ê±¸ê¹Œìš”?</p>\n<p><code class=\"language-text\">useInfiniteQuery</code>ë¥¼ ì‚¬ìš©í•˜ë©´ ë‘ ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì¸ <code class=\"language-text\">queryFn</code>ì˜ íŒŒë¼ë¯¸í„° ê°’ìœ¼ë¡œ <code class=\"language-text\">pageParam</code>ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n<code class=\"language-text\">pageParam</code>ì€ <code class=\"language-text\">useInfiniteQuery</code>ê°€ í˜„ì¬ ì–´ë–¤ í˜ì´ì§€ì— ìˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆëŠ” ê°’ì…ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token function\">useInfiniteQuery</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">[</span>QueryKey<span class=\"token punctuation\">.</span><span class=\"token constant\">GET_MY_CONTENTS</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> pageParam <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">fetchContents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token operator\">...</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ì´ì™€ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<h3>getNextPagePram</h3>\n<p><code class=\"language-text\">useInfiniteQuery</code>ë¥¼ ì‚¬ìš©í•  ë•Œ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸°ëŠ” ê°’ì— <code class=\"language-text\">getNextPageParam</code>ë¼ëŠ” ì˜µì…˜ì´ ìˆìŠµë‹ˆë‹¤. ì´ ì˜µì…˜ì€ ë°ì´í„°ë¥¼ ì¶”ê°€ë¡œ fetchí•˜ê¸° ìœ„í•´ ì§€ì •í•˜ëŠ” ë‹¤ìŒ í˜ì´ì§€ì˜ ê°’ì…ë‹ˆë‹¤.</p>\n<p>ìœ„ ì½”ë“œì—ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì¶”ê°€í•´ ì¤ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token function\">useInfiniteQuery</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">[</span>QueryKey<span class=\"token punctuation\">.</span><span class=\"token constant\">GET_MY_CONTENTS</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> pageParam <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">fetchContents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">getNextPageParam</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> page <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> page <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>page<span class=\"token punctuation\">.</span>isEndPage <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">.</span>number <span class=\"token operator\">??</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token operator\">...</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ê¸°ë³¸ì ìœ¼ë¡œ ë¦¬í„´í•˜ëŠ” ê°’ì€ <code class=\"language-text\">data.pages</code>ì´ê³  pageëŠ” Vì»¬ëŸ¬ë§ì—ì„œ ë¦¬í„´í•˜ëŠ” page object dataì…ë‹ˆë‹¤.\në§ˆì§€ë§‰ í˜ì´ì§€ê°€ ì•„ë‹Œ ê²½ìš°ì™€ í˜ì´ì§€ numberê°€ ìˆëŠ” ê²½ìš° 1ì”© ë”í•´ì„œ ë‹¤ìŒ í˜ì´ì§€ë¡œ ë„˜ê¸°ë„ë¡ í•´ ì£¼ëŠ” ì½”ë“œì…ë‹ˆë‹¤.</p>\n<h3>hasNextPage, fetchNextPage</h3>\n<p>ì´ì œ ìœ„ ì½”ë“œë¥¼ hookìœ¼ë¡œ ë§Œë“¤ì–´ ì‚¬ìš©í•´ ì£¼ë©´ ë©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> list<span class=\"token punctuation\">,</span>\n  isLoading<span class=\"token punctuation\">,</span>\n  hasNextPage<span class=\"token punctuation\">,</span>\n  isFetchingNextPage<span class=\"token punctuation\">,</span>\n  fetchNextPage<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useMyContents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token punctuation\">;</span><span class=\"token operator\">&lt;</span>InfiniteScroll hasMore<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>hasNextPage<span class=\"token punctuation\">}</span> loadMore<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>fetchNextPage<span class=\"token punctuation\">}</span> loader<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>loader<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>InfiniteScroll<span class=\"token operator\">></span></code></pre></div>\n<p>ì´ë ‡ê²Œ í˜¸ì¶œí•´ ì£¼ê¸°ë§Œ í•˜ë©´, <code class=\"language-text\">useInfiniteQuery</code>ì—ì„œ <code class=\"language-text\">getNextPageParam</code>ì„ ê¸°ë°˜ìœ¼ë¡œ íŒë‹¨í•œ <code class=\"language-text\">hasNextPage</code> ê°’ìœ¼ë¡œ ë” fetchë¥¼ í• ì§€ë¥¼ ê²°ì •í•´ ì£¼ê³ ,\në”°ë¡œ ë‹¤ìŒ í˜ì´ì§€ì˜ ê°’ì„ ë„˜ê¸°ì§€ ì•Šì•„ë„ <code class=\"language-text\">fetchNextPage</code> ê°’ìœ¼ë¡œ ìë™ìœ¼ë¡œ í˜ì´ì§€ ê°’ì„ ì¦ê°€ì‹œì¼œì„œ ë‹¤ìŒ APIë¥¼ í˜¸ì¶œí•´ ì¤ë‹ˆë‹¤.\nê·¸ë¦¬ê³  UIë¥¼ ê·¸ë¦¬ê¸° ìœ„í•´ì„œ listë¥¼ mergeí•˜ëŠ” ëª‡ ì¤„ì˜ ì½”ë“œë§Œ ë” ì‘ì„±í•´ ì£¼ë©´ êµ¬í˜„ì´ ì™„ë£Œë©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// useMyContents ì „ì²´ ì½”ë“œ</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">useMyContents</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> VRMy<span class=\"token punctuation\">.</span>IContentsType<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">usable</span><span class=\"token operator\">:</span> VRMy<span class=\"token punctuation\">.</span>IUsableType</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token function\">useInfiniteQuery</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">[</span>QueryKey<span class=\"token punctuation\">.</span><span class=\"token constant\">GET_MY_CONTENTS</span><span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> usable<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> pageParam <span class=\"token operator\">=</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">fetchContents</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span> usable<span class=\"token punctuation\">,</span> pageParam<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">staleTime</span><span class=\"token operator\">:</span> <span class=\"token constant\">ONE_HOUR</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function-variable function\">getNextPageParam</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> page <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n        page <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>page<span class=\"token punctuation\">.</span>isEndPage <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>page<span class=\"token punctuation\">.</span>number <span class=\"token operator\">??</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> pages <span class=\"token operator\">=</span> response<span class=\"token punctuation\">.</span>data<span class=\"token operator\">?.</span>pages\n  <span class=\"token keyword\">const</span> contentsList <span class=\"token operator\">=</span> pages<span class=\"token operator\">?.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">page</span> <span class=\"token operator\">=></span> page<span class=\"token operator\">?.</span>contentsList <span class=\"token operator\">||</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">flat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>pages<span class=\"token operator\">?.</span><span class=\"token function\">at</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> contentsList <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>response<span class=\"token punctuation\">,</span> data <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>ì´ìŠˆ</h2>\n<p>ì˜ ë™ì‘í•˜ëŠ” ê²ƒì€ í™•ì¸í–ˆì§€ë§Œ, ë„¤íŠ¸ì›Œí¬ íƒ­ì— ë“¤ì–´ê°€ ë³´ë‹ˆ 2í˜ì´ì§€ë¶€í„°ëŠ” APIê°€ ë‘ ë²ˆì”© í˜¸ì¶œë˜ëŠ” í˜„ìƒì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤.\nì²« ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì¸ <code class=\"language-text\">queryKey</code>ì— í˜ì´ì§€ ê°’ì´ í¬í•¨ë˜ì§€ ì•Šì•„ì„œ ê·¸ëŸ° ê±´ê°€ ìƒê°ì´ ë˜ì–´ <code class=\"language-text\">fetchNextPage</code>ë¥¼ ì´ìš©í•  ë•Œ ìˆ˜ë™ìœ¼ë¡œ pageë¥¼ ë„˜ê¸°ê³ , <code class=\"language-text\">queryKey</code>ì— í˜ì´ì§€ ì •ë³´ë¥¼ ë„£ëŠ” ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•´ ë³´ì•˜ìœ¼ë‚˜ ì—¬ì „íˆ ë¬¸ì œëŠ” ë°œìƒí•˜ì˜€ìŠµë‹ˆë‹¤.</p>\n<p>ì´ë²ˆì—ëŠ” ë°ì´í„°ë¥¼ ë‹¤ì‹œ fetchí•´ ì˜¬ ë•Œ <code class=\"language-text\">queryKey</code>ë¥¼ ì™„ì „íˆ <code class=\"language-text\">invalidate</code>ì‹œí‚¤ê³  ë‹¤ì‹œ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•ë„ ì‚¬ìš©í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.\nê·¸ë¦¬ê³  ì´ ê³¼ì •ì—ì„œ, <code class=\"language-text\">useInfiniteQuery</code>ì˜ ë¦¬í„´ê°’ ì¤‘ <code class=\"language-text\">refetch</code>ë¼ëŠ” ê°’ì´ ìˆë‹¤ëŠ” ê²ƒë„ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤. <code class=\"language-text\">refetch</code>ëŠ” ì‚¬ìš©í•˜ëŠ” ì‹œì ì— ê°•ì œë¡œ ë°ì´í„°ë¥¼ ë‹¤ì‹œ fetchí•´ ì˜¤ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤.</p>\n<h3>isFetchingNextPage</h3>\n<p>ì´ëŸ°ì €ëŸ° ë°©ë²•ìœ¼ë¡œë„ í•´ê²°ì´ ë˜ì§€ ì•Šì•„ ë™ë£Œì—ê²Œ ë„ì›€ì„ ì²­í•´ ë°©ë²•ì„ ì°¾ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.\në°”ë¡œ <code class=\"language-text\">InfiniteScroll</code>ì˜ <code class=\"language-text\">hasMore</code> ì†ì„±ì— <code class=\"language-text\">hasNextPage</code>ë¿ ì•„ë‹ˆë¼ <code class=\"language-text\">!isFetchingNextPage</code> ê°’ì„ ë„£ì–´ ì£¼ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ë°œìƒí•œ ë¬¸ì œì˜€ëŠ”ë°ìš”,\në°ì´í„°ê°€ ë” ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ íŒë‹¨í•  ë•Œ ë‹¤ìŒ í˜ì´ì§€ë¥¼ fetchingì¤‘ì¼ ë•Œë„ <code class=\"language-text\">hasNextPage</code> ê°’ì€ trueë¡œ ë¦¬í„´ë˜ê¸° ë•Œë¬¸ì— ì§§ì€ ì‹œê°„ ì•ˆì— APIê°€ í•œë²ˆ ë” í˜¸ì¶œë˜ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.</p>\n<p>ì•„ë˜ì™€ ê°™ì´ <code class=\"language-text\">!isFetchingNextPage</code> ì¡°ê±´ì„ ì¶”ê°€í•˜ë‹ˆ ë¬¸ì œ ì—†ì´ ê¹”ë”í•˜ê²Œ í•œ ë²ˆë§Œ í˜¸ì¶œë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤!\n(ëŠ˜ ë„ì›€ì„ ì£¼ì‹œê³  ì €ì˜ ë¶€ì¡±í•œ ë¶€ë¶„ì„ ì±„ì›Œì£¼ì‹œëŠ” kirimë‹˜ì—ê²Œ í•­ìƒ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤. ğŸ˜Š)</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> list<span class=\"token punctuation\">,</span>\n  isLoading<span class=\"token punctuation\">,</span>\n  hasNextPage<span class=\"token punctuation\">,</span>\n  isFetchingNextPage<span class=\"token punctuation\">,</span>\n  fetchNextPage<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useMyContents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token operator\">&lt;</span>InfiniteScroll\n  hasMore<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>hasNextPage <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span>isFetchingNextPage<span class=\"token punctuation\">}</span>\n  loadMore<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>fetchNextPage<span class=\"token punctuation\">}</span>\n  loader<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>loader<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>InfiniteScroll<span class=\"token operator\">></span></code></pre></div>\n<p>ì´ë ‡ê²Œ í•´ì„œ ë³´ê´€í•¨ ë¦¬ìŠ¤íŠ¸ì˜ ë¬´í•œ ìŠ¤í¬ë¡¤ ê¸°ëŠ¥ì„ <code class=\"language-text\">useInfiniteQuery</code>ë¥¼ ì´ìš©í•´ ì„±ê³µì ìœ¼ë¡œ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.</p>","frontmatter":{"title":"Next.js ì „í™˜ ê³¼ì • (5) - Infinite scroll ë°ì´í„°ì— react query ì ìš©í•˜ê¸°","date":"April 24, 2023","description":"Reactë¡œ êµ¬í˜„ëœ SPA (CSR) í”„ë¡œì íŠ¸ë¥¼ Next.jsë¡œ ì „í™˜í•˜ëŠ” ê³¼ì •","author":"jayoon"}},"previous":{"fields":{"slug":"/nextjs-refresh-token/"},"frontmatter":{"title":"Next.js ì „í™˜ ê³¼ì • (4) - ìë™ë¡œê·¸ì¸ (í† í° ê°±ì‹ )"}},"next":null},"pageContext":{"id":"553ca892-f753-50be-8a67-0948af59f705","previousPostId":"fce8c886-0c77-5b29-bc6d-08bb3c08f0f1","nextPostId":null}},"staticQueryHashes":["2841359383"],"slicesMap":{}}